1 TEXT
10 PRINT "STARTING ZBUDGET 0.031"
15 ONERR GOTO 11000
21 BC=50:REM "MAX BOND COUNT"
22 SS=500:REM "MAX STOCK COUNT"
25 DIM AI$(50):REM "ID":REM "ARRAYS FOR BONDS"
26 DIM AC(50):REM "CAPITAL" 
27 DIM AR(50):REM "RATE" 
28 DIM AM(50):REM "MATURITY" 
29 DIM AY(50):REM "YEARS TO MATURITY"
30 DIM AU$(50):REM "CURRENCY"
40 DIM ST$(500):REM "TICKER":REM "ARRAYS FOR STOCKS"
41 DIM SI(500):REM "BUY/SELL INDICATOR" 
42 DIM SP(500):REM "PRICE" 
43 DIM SQ(500):REM "QUANTITY"
44 DIM SD(500):REM "DATE" 
45 DIM SC$(500):REM "CURRENCY" 
46 PRINT "SO FAR OK"
50 CB=0:REM "CURRENT NUMBER OF BONDS"
51 CS=0:REM "CURRENT NUMBER OF STOCKS"
90 GOSUB 100
95 GOSUB 11000
100 REM "LOAD DB ROUTINE"
110 PRINT CHR$(4) "OPEN ZBUDGETDB"
120 PRINT CHR$(4) "READ ZBUDGETDB"
125 INPUT CB:REM "READ BOND DATA"
126 FOR I = 1 TO BC 
127 INPUT AI$(I):INPUT AC(I):INPUT AR(I):INPUT AM(I):INPUT AY(I):INPUT AU$(I)
128 NEXT I
130 INPUT CS:REM "READ STOCK DATA"
131 FOR I = 1 TO SS 
132 INPUT ST$(I):INPUT SI(I):INPUT SP(I):INPUT SQ(I):INPUT SD(I):INPUT SC$(I)
133 NEXT I
140 PRINT CHR$(4) "CLOSE ZBUDGETDB"
150 RETURN
200 REM "WRITE DB ROUTINE"
210 PRINT CHR$(4) "OPEN ZBUDGETDB"
220 PRINT CHR$(4) "WRITE ZBUDGETDB"
225 PRINT CB:REM "WRITE BOND DATA"
226 FOR I = 1 TO BC
227 PRINT AI$(I):PRINT AC(I):PRINT AR(I):PRINT AM(I):PRINT AY(I):PRINT AU$(I)
228 NEXT I
230 PRINT CS:REM "WRITE STOCK DATA"
231 FOR I = 1 TO SS
232 PRINT ST$(I):PRINT SI(I):PRINT SP(I):PRINT SQ(I):PRINT SD(I):PRINT SC$(I)
233 NEXT I
240 PRINT CHR$(4) "CLOSE ZBUDGETDB"
250 RETURN
300 REM "NEW INPUT ROUTINE"
301 HOME:POKE 37,17: CALL -922: CALL -998: POKE 36,0:PRINT "PLEASE ENTER WHICH LINE TO EDIT (1-10)"
303 INPUT "";LN:IF LN < 1 OR LN > 10 THEN PRINT "OUT OF RANGE":GOTO 301
304 GOSUB 700:PRINT "PLEASE ENTER ID(MAX 4 CHARACTER)":INPUT "";AI$(LN)
310 GOSUB 700:PRINT "PLEASE ENTER CAPITAL":INPUT "";AC(LN)
330 GOSUB 700:PRINT "PLEASE ENTER INTEREST":INPUT "";AR(LN)
350 GOSUB 700:PRINT "PLEASE ENTER MATURITY (FORMAT: YYYYMMDD)":INPUT "";AM(LN)
370 GOSUB 700:PRINT "PLEASE ENTER YEARS TO MATURITY":INPUT "";AY(LN)
390 RETURN
400 REM "DISPLAY INSTRUMENTS"
409 POKE 37,1: CALL -922: CALL -998: POKE 36,0:PRINT "  !ID  !CAPITAL!INTR!MATR    !PAID"
410 TC=0:REM "TOTAL CAPITAL"
411 TP=0:REM "TOTAL PAID"
414 FOR I = 1 TO 10 
415 POKE 37,I+1: CALL -922: CALL -998: POKE 36,0:PRINT I
416 POKE 37,I+1: CALL -922: CALL -998: POKE 36,2:PRINT "!"AI$(I)
420 POKE 37,I+1: CALL -922: CALL -998: POKE 36,7:PRINT "!"AC(I)
460 POKE 37,I+1: CALL -922: CALL -998: POKE 36,15:PRINT "!"AR(I)
465 POKE 37,I+1: CALL -922: CALL -998: POKE 36,20:PRINT "!"AM(I)
470 POKE 37,I+1: CALL -922: CALL -998: POKE 36,29:PRINT "!"AC(I)+AC(I)*AR(I)*AY(I)
471 TC=TC+AC(I):TP=TP+AC(I)+AC(I)*AR(I)*AY(I)
480 NEXT I 
481 PRINT "":PRINT "TOTAL INVESTED: "TC:PRINT "TOTAL PAID    : "TP:PRINT "TOTAL EARNED  : "TP-TC
580 RETURN
700 REM "DISPLAY BOND DETAILS"
710 HOME:POKE 37,1: CALL -922: CALL -998: POKE 36,0:PRINT "BOND NAME: "AI$(LN)
720 PRINT "CAPITAL  : "AC(LN):PRINT "RATE     : "AR(LN):PRINT "MATURITY : "AM(LN):PRINT "YEARS    : "AY(LN)
790 POKE 37,17: CALL -922: CALL -998: POKE 36,0
800 RETURN
1000 REM "DISPLAY BOND":PRINT "HIT ANY KEY TO RETURN":INPUT AA:RETURN
999 HOME:GOSUB 400:POKE 37,17: CALL -922: CALL -998: POKE 36,0
1020 INPUT "WHICH BOND TO BE DISPLAYED?";LN:GOSUB 710
1030 INPUT "HIT ANY KEY TO RETURN";AA
1500 RETURN
11000 HOME
11002 PRINT "ZBUDGET"
11003 GOSUB 400
11004 POKE 37,17: CALL -922: CALL -998: POKE 36,0
11010 PRINT "PLEASE SELECT FROM OPTIONS BELOW"
11040 PRINT "1) STORE INSTRUMENTS"
11050 PRINT "2) NEW INSTRUMENT"
11060 PRINT "3) SHOW DETAILS"
11080 PRINT "9) EXIT"
11090 INPUT OP
11120 IF OP = 1 THEN GOSUB 200
11130 IF OP = 2 THEN GOSUB 300
11140 IF OP = 3 THEN GOSUB 1000
11150 IF OP = 9 THEN GOSUB 20010
20000 GOTO 11000
20010 HOME
20015 PRINT "ERROR"
20020 END
